name: IndexNow Notify

on:
  push:
    branches: [main]
    paths:
      - 'frontend/app/**'
      - 'frontend/messages/**'
      - 'frontend/lib/sitemapData.ts'
      - 'frontend/lib/compare-hub/**'
      - 'frontend/config/**'
      - 'frontend/public/robots.txt'
      - 'content/**'
      - 'vercel.json'
      - '.github/workflows/indexnow.yml'

jobs:
  indexnow:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Submit changed URLs + sitemaps to IndexNow proxy
        env:
          SITE: https://maxvideoai.com
          GITHUB_EVENT_BEFORE: ${{ github.event.before }}
          GITHUB_SHA: ${{ github.sha }}
        run: |
          node scripts/indexnow-submit-changed.mjs
